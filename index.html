<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset='utf-8'>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Notation3: A Practical Introduction</title>
  
  <link rel="stylesheet" href="lib/default.css" />

  <script src="lib/jquery-3.5.1.min.js"></script>
  <script src="lib/shortcut.js"></script>
  <script src="lib/codemirror-5.54.0/lib/codemirror.js"></script>
  <link rel="stylesheet" href="lib/codemirror-5.54.0/lib/codemirror.css">
  <link rel="stylesheet" href="lib/codemirror-5.54.0/addon/lint/lint.css">
  <script src="lib/codemirror-5.54.0/addon/lint/lint.js"></script>
  <script src="lib/codemirror-5.54.0/addon/edit/matchbrackets.js"></script>
  <script src="lib/dist/n3Main.js"></script>
  <script src="lib/codemirror-n3/namespaces.js"></script>
  <script src="lib/codemirror-n3/lint.js"></script>
  <script src="lib/codemirror-n3/n3-mode.js"></script>
  <link rel="stylesheet" href="lib/codemirror-n3/rdf.css">

  <!-- <script src="https://eyereasoner.github.io/eye-js/2/latest/index.js"></script> -->

  <script src="lib/dfn.js"></script>
  <script src="lib/stylize.js"></script>

  <script>
    function loaded() {
      stylizeSamples();
      mapDfn();
    }
  </script>

</head>

<body onload="loaded()">
  <h1>Notation3: A Practical Introduction</h1>

  <p id='abstract'>
    N3 is

    This practical introduction is meant to get people started with Notation 3 (also known as N3),
    an assertion and logic language that is a superset of RDF.
    It introduces the various language constructs, design patterns,
    and useful resources such as tool support and other educational resources.
  </p>

  <div class="menu">
    <ol type="A">
      <li><a href="#language">Language</a>
        <ol type="1">
          <li><a href="#n3doc">N3 document</a></li>
          <li><a href="#simpletriples">Simple triples</a></li>
          <li><a href="#polists">Predicate and object lists</a></li>
          <li><a href="#iris">IRIs</a></li>
          <li><a href="#literals">Literals</a></li>
          <li><a href="#bnodes">Blank nodes</a></li>
          <li><a href="#collections">Collections</a></li>
          <li><a href="#quotedgraphs">Quoted graphs</a></li>
          <li><a href="#n3rules">N3 rules</a></li>
          <li><a href="#builtins">N3 builtins</a></li>
          <li><a href="#paths">Resource paths</a></li>
        </ol>
      </li>
      <li><a href="#patterns">Design patterns</a>
        <ol type="1">
          <li><a href="#naryrel">N-ary relations</a></li>
          <li><a href="#compoundliteral">Compound literal</a></li>
          <li><a href="#reification">Quoted graphs</a></li>
        </ol>
      </li>
      <li><a href="#useful_resources">Useful resources</a>
        <ol type="1">
          <li><a href="#n3_reasoners">N3 reasoners</a></li>
          <li><a href="#n3_editors">N3 editors</a></li>
          <li><a href="#educational">Educational resources</a></li>
        </ol>
      </li>
    </ol>
  </div>

  <section id="n3_editors">
    <h3>N3 Editors</h3>
    <p>These N3 editors support one or more of the reasoners listed in the <a href="n3_reasoners">reasoner
        section</a>.</p>
    <ul>
      <li>Online N3-editor: <a href="https://editor.notation3.org">https://editor.notation3.org</a><br />
        (GitHub repo: <a
          href="https://github.com/william-vw/n3-editor-js">https://github.com/william-vw/n3-editor-js</a>).

      </li>
      <li>VSCode N3 extension with language, execution, and debugging support: <br />
        <a
          href="https://marketplace.visualstudio.com/items?itemName=w3cn3.n3-lang-exec">https://marketplace.visualstudio.com/items?itemName=w3cn3.n3-lang-exec</a><br />
        (GitHub repo: <a
          href="https://github.com/william-vw/vscode-extension-n3">https://github.com/william-vw/vscode-extension-n3</a>).
      </li>
    </ul>
    </p>
  </section>
  <section id="n3_reasoners">
    <h3>N3 Reasoners</h3>
    <ul>
      <li><b>Prolog / Command Line</b> - EYE: <a
          href="https://github.com/eyereasoner/eye">https://github.com/eyereasoner/eye</a> (advanced N3
        reasoner, used in industrial settings)</li>
      <li><b>Java</b> - jen3: <a href="https://github.com/william-vw/jen3">https://github.com/william-vw/jen3</a> (<a
          href="https://jena.apache.org/">Apache Jena</a> extended with N3
        reasoning)</li>
      <li><b>Python</b> - Cwm: <a
          href="https://www.w3.org/2000/10/swap/doc/cwm.html">https://www.w3.org/2000/10/swap/doc/cwm.html</a>
        ("prototype" N3 reasoner developed by TBL; no longer
        maintained)</li>
      <li><b>Rust</b> - roxi: <a href="https://github.com/pbonte/roxi">https://github.com/pbonte/roxi</a> (N3 reasoner
        in rust)
      </li>
      <li>Data-Fu: <a href="https://aifb.kit.edu/web/Linked_Data-Fu">https://aifb.kit.edu/web/Linked_Data-Fu</a>
        (reasoner and language supporting a subset of N3)</li>
    </ul>
  </section>
  <section id="educational">
    <h3>Educational Resources</h3>
    <ul>
      <li><a href="https://drive.google.com/file/d/18m8m-gqaOdPe1YLg7KdgKrMAesero-pn/view">Notation3 Logic: A
          Practical Introduction</a>. By Doerthe Arndt.
      </li>
      <li>
        <a href="https://n3.restdesc.org/">Semantic Web Reasoning With N3.</a> By Ruben Verborgh.
      </li>
    </ul>

  </section>

  <section id='language'>
    <h2>Language</h2>
    <section id='n3doc'>
      <h3>N3 document</h3>
      <p>An <dfn>N3 document</dfn> represents an <dfn>N3 graph</dfn> in a textual form,
        which is a series of <dfn data-lt="statement|triple">N3 statements</dfn>. These are written as triples
        consisting of a
        <dfn>subject</dfn>,
        <dfn>predicate</dfn>, and
        <dfn>object</dfn> resource.
        An <dfn data-lt="resource|N3 resource">N3 resource</dfn> can be an RDF <a>IRI</a>, <a>literal</a> or <a>blank
          node</a>; or an N3 <a>quoted
          graph</a>, <a>collection</a>,
        <a>logical implication</a>, <a>variable</a> or <a>N3
          builtin</a>.
        Comments are indicated using a separate '#' and continue until the end of the line.
      </p>
    </section>
    <section id='simpletriples'>
      <h3>Simple triples</h3>
      <p>The simplest <a>N3 statement</a> or <a>triple</a> is a sequence of a
        subject,
        predicate, and
        object resource,
        separated by whitespace and terminated by '<code>.</code>' after each <a>triple</a>.
      <p>In the example below, three N3 triples highlight the enmity between Spiderman and the Green Goblin and
        lists their human-readable names:</p>

      <textarea id="basic-triples-example" class="n3code"><http://example.org/#spiderman> 
    <http://example.org/#enemyOf> <http://example.org/#green-goblin> .
<http://example.org/#spiderman> 
    <http://xmlns.com/foaf/0.1/name> "Spiderman" .
<http://example.org/#green-goblin> 
    <http://xmlns.com/foaf/0.1/name> "Green Goblin" .</textarea>

      <p>For now, we will asssume that a resource is represented either by an <a>IRI</a> or a <a>literal</a>.
        In general, one uses an <a>IRI</a> to identify an identifiable entity such as a person, place, or thing &mdash;
        a literal is used for a textual or numerical (i.e., datatype) value, such as name, date, height, and so on.</p>

      <p class="note">There is no inherent order for N3 or RDF triples. The same is true for the relational database
        model, i.e., relational tuples or rows do not have an inherent order. Hence, it is a mistake to associate
        meaning with the order of statements in an N3 document (e.g., assuming that a first listed telephone for
        Spiderman is their landline, and the second one their mobile number).</p>
      <!-- <p class="note">Examples will often be written using newlines and tab spaces for readability. However, generally, only the subjects, predicates and objects need to be separated with a whitespace.</p> -->
      <!-- <pre class="example nohighlight">&lt;http://example.org/#dt&gt; &lt;http://xmlns.com/foaf/0.1/name&gt; &quot;Dominik Tomaszuk&quot; .</pre> -->
    </section>
    <section id='polists'>
      <h3>Predicate and object lists</h3>
      <p>As shown in the above example, the same subject (here, Spiderman) will often be described by several <a>N3
          statements</a>.
        To make these <a>N3 statements</a> less cumbersome to write, one can put a semicolon ("<code>;</code>") at the
        end of an <a>N3 statement</a> to describe the same subject in the subsequent statement:</p>
      <textarea class="n3code"><http://example.org/#spiderman>
    <http://example.org/#enemyOf> <http://example.org/#green-goblin> ;
    <http://xmlns.com/foaf/0.1/name> "Spiderman" .</textarea>
      <!-- <pre class="example nohighlight">&lt;http://example.org/#dt&gt; &lt;http://xmlns.com/foaf/0.1/firstName&gt; &quot;Dominik&quot; ;
          &lt;http://xmlns.com/foaf/0.1/lastName&gt; &quot;Tomaszuk&quot; .</pre> -->
      <p>Similarly, a predicate (e.g., name) can often list multiple objects for the same subject (e.g., Spiderman).
        This can be written by listing the object values separated by a '<code>,</code>':</p>
      <textarea class="n3code" id="object-lists-example"><http://example.org/#spiderman>
    <http://xmlns.com/foaf/0.1/name> "Spiderman", "Peter Parker" .</textarea>
      <!-- <pre class="example nohighlight">&lt;http://example.org/#dt&gt; &lt;http://xmlns.com/foaf/0.1/nick&gt; &quot;Domel&quot;, &quot;Misiek&quot;@pl .</pre> -->
    </section>
    <section id='iris'>
      <h3>IRIs</h3>
      <p>An IRI is used to represent an identifiable entity &mdash; such as a person, place, or thing.
        Until now, we have been writing absolute <dfn data-lt="absolute iri|iri">IRIs</dfn> (<a
          href="https://www.rfc-editor.org/rfc/rfc3987">RFC3987</a>) (e.g.,
        <code>http://example.org/#Spiderman</code>), which include both the namespace (e.g.,
        <code>http://example.org/#</code>) and the local name (e.g., <code>Spiderman</code>).
      </p>

      <p>It is often much easier to write an IRI as a <dfn>prefixed name</dfn> &mdash; e.g.,
        <code>ex:Spiderman</code>,
        which includes a <dfn>prefix label</dfn> (e.g., <code>ex</code>) as a shorthand for the namespace,
        and the <dfn>local name</dfn> (e.g., <code>Spiderman</code>), separated by a colon ("<code>:</code>").
        The <code>@prefix</code> directives associate the <a>prefix label</a>
        with a <dfn>namespace IRI</dfn>. A prefixed name is turned into an absolute <a>IRI</a>
        by concatenating the <a>namespace IRI</a> with the <a>local name</a>.
        The following example is equivalent to the <a href="#basic-triples-example">original example</a>:
      </p>
      <textarea class="n3code" id="prefixed-names-example">@prefix ex: <http://www.example.org/#> .
@prefix foaf: <http://xmlns.com/foaf/0.1/> .

ex:spiderman ex:enemyOf ex:green-goblin ;
    foaf:name "Spiderman" .
ex:green-goblin foaf:name "Green Goblin" .</textarea>

      <p class="note">N3 also supports
        case-insensitive <code>PREFIX</code> and <code>BASE</code> directives, as does Turtle,
        to align the syntax with SPARQL (see grammar).
        These do not have a trailing '.'.
      </p>

      <p>To further simplify prefixed names, one can leave the <a>prefix label</a> empty (e.g., for an often-used
        namespace):</p>
      <textarea class="n3code" id="empty-prefix-example">@prefix : <http://www.example.org/#> .

:spiderman :enemyOf :green-goblin .</textarea>

      <p>One can also write <dfn data-lt="relative iri">relative IRI references</dfn>, e.g.,
        <code>&lt;#Spiderman&gt;</code>.
        A relative IRI reference is resolved, i.e., turned into an <a>absolute
          IRI</a>, by concatenating the base IRI with the <a>local name</a> (e.g., <code>Spiderman</code>).
        A <dfn>base IRI</dfn> is defined using the <code>@base</code> directive.
        For instance, the following is equivalent to the <a href="#empty-prefix-example">prior example</a>:
      </p>
      <textarea class="n3code" id="relative-iri-example">@base <http://www.example.org/#> .

<#spiderman> <#enemyOf> <#green-goblin> .</textarea>

      <p class="note">We recommend listing <code>@prefix</code> / <code>PREFIX</code> and <code>@base</code> /
        <code>BASE</code> declarations
        at the top of an <a>N3 document</a>.
        This is not mandatory, however,
        and they can technically be put anywhere before
        the <a>prefixed name</a> or <a>relative IRI</a>
        that relies on the declaration.
        Subsequent <code>@prefix</code> / <code>PREFIX</code> directives may "re-map"
        the same <a>prefix label</a> to another <a>namespace IRI</a>.
      </p>

      <div class="note">
        <p>Prefixed names are a superset of <a href="https://www.w3.org/2001/tag/doc/qnameids.html">XML QNames</a>.
          They differ in that the local name may include:</p>

        <ul>
          <li>leading digits, e.g. <code>leg:3032571</code> or <code>isbn13:9780136019701</code></li>
          <li>non leading colons, e.g. <code>og:video:height</code></li>
          <li>reserved character escape sequences, e.g. <code>wgs:lat\-long</code></li>
        </ul>
      </div>

      <!-- <pre class="example nohighlight">@prefix foaf: &lt;http://xmlns.com/foaf/0.1/&gt; .
          @prefix : &lt;http://example.org/#&gt;

          &lt;http://example.org/#doerthe&gt; foaf:knows &lt;http://example.org/#dominik&gt; .
          :doerthe foaf:knows :dominik .</pre> -->

      <section id='iriprplist'>
        <h4>IRI property lists</h4>
        <p>
          In many cases, an <a>IRI</a> occurs only once as an object, and is then further described as a subject in
          other statements
          (e.g., see a <a href="#prefixed-names-example">prior example</a>).
          The <a href="#iri-prp-list-unfolded">example below</a> illustrates how this may result in difficult-to-read
          code:
          to find descriptions of <a>IRI</a> objects such as <code>tobey-maguire</code> or <code>willem-dafoe</code>,
          one must scan the full
          <a>N3 graph</a>,
          as they are only described near the end.
        </p>

        <p>Using the IRI property list syntax, descriptions of these object <a>IRIs</a> can be directly "embedded"
          within the object position:</p>

        <table class="ex">
          <tr>
            <th>Using basic statements:</th>
            <th>Using IRI property lists:</th>
          </tr>
          <tr>
            <td>
              <textarea class="n3code" id="iri-prp-list-unfolded">@prefix : <http://example.org/#> .
@prefix foaf:<http://xmlns.com/foaf/0.1/>.
    
:spiderman 
:enemyOf :green-goblin ;
  :portrayedBy :tobey-maguire .
    
:green-goblin 
  :portrayedBy :willem-dafoe .

:tobey-maguire a :Actor .
:willem-dafoe a :Actor .
</textarea>
            </td>
            <td>
              <textarea class="n3code" id="iri-prp-list">@prefix : <http://example.org/#> .
@prefix foaf:<http://xmlns.com/foaf/0.1/>.
    
:spiderman 
  :enemyOf 
    [ id :green-goblin 
      :portrayedBy [ id :willem-dafoe
        a :Actor 
      ]
    ] ;
    :portrayedBy [ id :tobey-maguire
        a :Actor
    ] .</textarea>
            </td>
          </tr>
        </table>

        <p>IRI property lists build on the <a href="#polists">predicate object list</a> syntax to group statements
          about
          <a>IRIs</a>.
          One can use <a href="#object-lists-example">objects lists</a> in this syntax as well.
        </p>

        <p class="note">See also the <a href="#bnodeprplist">blank node property list</a> syntax.</p>
      </section>

    </section>

    <section id='literals'>
      <h3>Literals</h3>
      <p><dfn>Literals</dfn> are used to represent a textual or numerical (i.e., datatype) value, such as name,
        date, height, and so on. Numbers (integers, decimals, and doubles) are simply represented using their
        numerical value, and booleans are represented using <code>true</code> or <code>false</code>:</p>
      <textarea class="n3code">@prefix : <http://example.org/elements> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .

<http://en.wikipedia.org/wiki/Helium>
  :atomicNumber 2 ;               # xsd:integer
  :atomicMass 4.002602 ;          # xsd:decimal
  :specificGravity 1.663E-4 ;     # xsd:double
  :isNobleGas true ;              # xsd:boolean
  rdfs:label "Helium" .           # xsd:string</textarea>
      <p>For details on numerical syntaxes (e.g., decimals, doubles), we refer to the <a
          href="https://www.w3.org/TR/turtle/#abbrev">RDF
          1.1: Turtle (Section 2.5.2)</a> specification.</p>
      <p>Other literals, such as strings, but also dates, binary, octal or hex code, XML or JSON code, or other types
        of
        numbers (e.g., shorts), need to be written as <b>string literals</b>. If the literal is not a string, its
        particular datatype must be indicated using the <code>^^</code> symbol and the corresponding <dfn
          href="https://www.w3.org/TR/xmlschema11-2/#built-in-datatypes">datatype IRI</dfn>. For instance:</p>

      <textarea class="n3code">@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix : <http://example.org/#> .

:spiderman
  :birthDate "2001-08-10"^^xsd:date .</textarea>
      <p>
        The literal's <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-lexical-form">lexical form</a> will include the
        characters between
        the delimiter quotes (e.g., <code>2001-08-10</code>).</p>

      <p>The language of the string literal can be indicated using the <code>@</code> symbol and the corresponding
        language tag (as defined in <a href="https://www.rfc-editor.org/rfc/rfc5646">BCP47</a> &mdash;
        find the registry in <a
          href="http://www.iana.org/assignments/language-subtag-registry/language-subtag-registry">LNG-TAG</a>). For
        instance:</p>
      <textarea class="n3code">@prefix foaf: <http://xmlns.com/foaf/0.1/> .
@prefix : <http://example.org/#> .

:spiderman foaf:name "Spiderman"@en ,
  "Hombre Araña"@es , "Homme Araignée"@fr .</textarea>
      <p>The reading direction can be described together with the language <a
          href="https://www.rfc-editor.org/rfc/rfc5646">BCP47</a>,
        using the <code>i18n</code> namespace:</p>
      <textarea class="n3code">@prefix i18n: <https://www.w3.org/ns/i18n#> .
@prefix foaf: <http://xmlns.com/foaf/0.1/> .
@prefix : <http://example.org/#> .

:spiderman foaf:name "الرجل العنكبوت"^^i18n:ar-eg_rtl .</textarea>

      <p class="note">If no <a>datatype IRI</a> or language tag is given, the datatype <code>xsd:string</code> will be
        assumed. In case a language tag is given, the datatype <code>rdf:langString</code> will be assumed. Note that
        it
        is not possible to specify both a <a>datatype IRI</a> and a language tag.</p>

      <p class="note">Integers, decimals, doubles, and booleans may also be written as string literals with the
        appropriate <a>datatype IRI</a> (e.g., <code>"8"^^xsd:int</code> or "true"^^xsd:boolean).
      </p>

      <p class="note">There are also <a href="#compoundliteral">other mechanisms</a> for describing the language tag
        and
        base direction of RDF literals.</p>

      <p>In case the the string literal itself contains the string delimiter (e.g., double quotes), or includes
        newlines, other string delimiters can be used, i.e., single quotes or compound delimiters <code>"""</code> or
        <code>'''</code>.
        Alternatively, one can also use a '<code>\</code>' for escaping the delimiter each time it occurs within a
        string literal.
        For instance:
      </p>
      <textarea id="string-literal-example" class="n3code">@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix : <http://example.org/#> .

:spiderman rdfs:label 
  '"Bitten" by a radioactive spider.' ,
  "\"Bitten\" by a radioactive spider." ,
  """'Bitten' by "what"?
  A radioactive spider!""" .</textarea>

      <p>The escape symbol '<code>\</code>' (<span class="codepoint">U+005C</span>) may only appear in a
        string literal as part of an <a href="#escseq">escape sequence</a>. Other restrictions within string literals
        depend on the delimiter:</p>
      <ul>
        <li>Literals delimited by <code>'</code> may not contain the characters
          <code>'</code>, <code title="LINE FEED"><sub>LF</sub></code> (<span class="codepoint">U+000A</span>), or
          <code title="CARRIAGE RETURN"><sub>CR</sub></code> (<span class="codepoint">U+000D</span>).
        </li>
        <li>Literals delimited by <code>&quot;</code> may not contain the characters <code>&quot;</code>, <code
            title="LINE FEED"><sub>LF</sub></code>, or <code title="CARRIAGE RETURN"><sub>CR</sub></code>.
        </li>
        <li>Literals delimited by <code>'''</code> may not contain the sequence of characters <code>'''</code>.
        </li>
        <li>Literals delimited by <code>&quot;&quot;&quot;</code> may not contain the sequence of characters
          <code>&quot;&quot;&quot;</code>.
        </li>
      </ul>
      <!-- <pre class="example nohighlight">@prefix : &lt;http://example.org/vocab/&gt; .
          @prefix rdfs: &lt;http://www.w3.org/2000/01/rdf-schema#&gt; .
          @prefix xsd: &lt;http://www.w3.org/2001/XMLSchema#&gt; .

          _:x rdfs:comment &quot;This is an example.&quot;^^xsd:string . # literal with XML Schema string datatype
          _:x rdfs:comment &quot;This is an example.&quot;^^&lt;http://www.w3.org/2001/XMLSchema#string&gt; . # same as above
          _:x rdfs:comment &quot;This is an example.&quot; .  # same again
          _:x rdfs:comment &quot;To jest przykład.&quot;@pl . # literal with a language tag
          _:x rdfs:comment 'Ceci est un exemple.'@fr . # literal delimited by single quote
          _:x rdfs:comment '''This # literal with embedded new lines
          is
          an example.''' .
          </pre> -->
    </section>
    <section id='bnodes'>
      <h3>Blank Nodes</h3>
      <p>When describing resources in RDF, you can run into the following situations:</p>
      <ul>
        <li>
          It is not worth minting a new <a>IRI</a> for the resource, as it is unlikely that other <a>N3 graphs</a>
          will refer to it.
        </li>
        <li>
          There likely already exists an <a>IRI</a> for the resource, and we don't want to do an extensive search to
          find out what it is.
        </li>
      </ul>
      <p>Instead, you can use <dfn>blank nodes</dfn> to talk about resources.
        They are existential variables; that is, they state the existence of a thing without identifying it.
        <a>Blank nodes</a> can be represented in several ways, as described below.
        For details, please refer to <a href="https://www.w3.org/TR/rdf11-concepts/">RDF11-CONCEPTS</a>.
      </p>
      <section id='bnodeids'>
        <h3>Blank node identifiers</h3>
        <p>A <a>blank node</a> can be represented by a <dfn>blank node identifier</dfn>,
          which is unique within the <a>N3 graph</a>, expressed as <code>_:someLabel</code>.
          Then, we use this identifier within our <a>N3 graph</a> to describe the corresponding resource, same as with
          an <a>IRI</a>.
        <p>For instance, <a href="https://www.w3.org/TR/rdf11-primer/#section-blank-node">this example</a> shows that
          the Mona Lisa
          has an unidentified tree in its background. We don't want to concretely identify this tree, but we do want
          to
          describe it &mdash;
          such as the painting it is in, and the type of tree:
        </p>
        <textarea id="mona-lisa-bnode-id" class="n3code">@prefix ex: <http://example.org/#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .

ex:mona_lisa_painting ex:portrays _:someTree .
_:someTree rdf:type ex:CypressTree .</textarea>
        <p>In this example, we minted a <a>blank node identifier</a> <code>_:someTree</code> to represent the resource
          that
          we want to describe. Note that this identifier is only usable within our local <a>N3 graph</a> &mdash;
          if you want other <a>N3 graphs</a> to describe it, you should represent it using an <a>IRI</a>.</p>
      </section>
      <section id='bnodeprplist'>
        <h3>Blank node property lists</h3>
        <p>Using a <a>blank node identifier</a> requires introducing a new identifier for each <a>blank node</a>.
          In many cases, however, a blank node occurs only once as an object,
          and is then further described as a subject in other statements, such as in the <a
            href="#mona-lisa-bnode-id">prior example</a>.
          In those cases, a more convenient syntax can be used.</p>
        <p>
          The <a href="#address-bnode-prp-list-simplified">example below</a> shows a more elaborate example:
          identifiers <code>_:a</code> and <code>_:t</code> are used as object in only one statement,
          and are then described as subject in other statements.
          Using the blank node property list syntax, these cases can be represented as follows:</p>

        <table class="ex">
          <tr>
            <th>Using blank node identifiers:</th>
            <th>Using blank node property lists:</th>
          </tr>
          <tr>
            <td>
              <textarea class="n3code" id="address-bnode-prp-list-simplified">@prefix ex: <http://example.org/#> .
ex:john ex:address _:a .
_:a ex:street "Evergreen Terrace" .
_:a ex:number 742 .
_:a ex:town _:t .
_:t ex:name "Springfield" .
</textarea>
            </td>
            <td>
              <textarea class="n3code" id="address-bnode-prp-list">@prefix ex: <http://example.org/#> .

ex:john ex:address [
  ex:street "Evergreen Terrace" ;
  ex:number 742 ;
  ex:town [ ex:name "Springfield" ]
] .</textarea>
            </td>
          </tr>
        </table>

        <p class="note">See also the <a href="#iriprplist">IRI property list</a> syntax.</p>

        <p>As mentioned, this syntax is useful for cases where a blank node occurs only once as an object.
          In case the blank node occurs several times as an object, such as describing multiple people with the same
          address,
          one should use blank node identifiers. For instance:</p>

        <textarea class="n3code" id="address-multiple-people">@prefix ex: <http://example.org/#> .

ex:john ex:address _:a .
ex:sally ex:address _:a .
_:a ex:street "Evergreen Terrace" .
_:a ex:number 742 .
_:a ex:town [ ex:name "Springfield" ] .</textarea>
        <p>We can still use the blank node property list syntax for describing the town,
          as this blank node still only occurs once as object.</p>
        </p>
      </section>

      <section id="bnode-use-cases">
        <h3>Blank node use cases</h3>
        <p>Below, we summarize typical use cases where <a>blank nodes</a> are used to describe resources.</p>
        <p><strong>Unknown resources</strong>: we might <a
            href="https://www.w3.org/TR/rdf11-primer/#section-blank-node">want to state</a>
          that the Mona Lisa painting has in its background an unidentified tree, which we know to be a cypress tree.
          We
          could mint an <a>IRI</a> such as "mona-lisa-cypress-tree", but we feel that would be redundant &mdash; we
          simply want to describe the tree, such as the painting it is in, and the type of tree. We're not
          particularly
          interested in allowing other <a>N3 graphs</a> to refer to the tree. Moreover, there may already exist an
          <a>IRI</a> for that particular tree, and we don't want to mint another <a>IRI</a> to refer to the same tree
          (nor do we want to lookup this existing <a>IRI</a>).
        </p>
        <p><strong>Composite information</strong>: when describing composite pieces of information, such as street
          addresses,
          telephone numbers and dates, it is often unlikely that anyone outside this <a>N3 graph</a> would need to
          refer
          to this address or its pieces.
          Hence, it would be redundant to mint an <a>IRI</a> just for the purpose of structuring this information.
          Instead, one can use a <a data-lt="blank node">blank node</a> to connect the
          "composed" pieces of information, e.g., the street address, to its composite values, e.g., street name,
          number,
          and city, as shown in <a href="#address-bnode-prp-list">this example</a>.</p>
        <p><strong>N-ary relations</strong>: <a>blank nodes</a> are a convenient way to represent <a
            href="#nary-binary-rel">n-ary relations in N3</a>.</p>
        <!--
            <pre class="example nohighlight">@prefix foaf: &lt;http://xmlns.com/foaf/0.1/&gt; .

            _:doerthe foaf:knows _:dominik .
            _:dominik foaf:knows [ foaf:firstName &quot;William&quot; ].</pre>
            -->
      </section>
    </section>
    <section id='collections'>
      <h3>Collections</h3>
      <p>We often need to describe ordered collections of things, e.g., a book written by several authors,
        listing the students in a course, or the software modules within a package. N3 provides a succinct <dfn
          data-lt="n3 collection|n3 list|list">collection</dfn> syntax to represent ordered collections of
        resources enclosed by <code>(</code> <code>)</code>. The contained resources are called <dfn
          data-lt="collection member">members</dfn>.</p>
      <p>For instance:</p>
      <textarea class="n3code">@prefix : <http://example.org/#> .

:description_logic_handbook a :Book ;
  :author ( :deborah :daniele :peter) .</textarea>
      <p>This states that the value of the author property is the <em>collection resource</em>.</p>
      <p class="note"><strong>Any additional meaning is not given by the N3 semantics</strong>.
        For instance, this example does not imply that each <a>member</a> (e.g.,
        <code>:deborah</code>) can be considered as a value of the author property &mdash; i.e., the author property
        does not "distribute" across the <a>members</a>.
        For that matter, it is also not implied that the first <a>member</a> put the most effort into the book.
        Any additional meaning, such as each member being an author of the book,
        and the ordering reflecting the authors' effort, would always be application-specific.<br />
        <br />
        In general, to implement such application-specific meanings, N3 rules could be used.
        Alternatively, one could use an <a href="#object-lists-example">object list</a>
        to explicitly state that each of these resources are authors of the book: <br />
        &nbsp;&nbsp;&nbsp;&nbsp;<code>:description_logic_handbook :author :deborah, :daniele, :peter .</code><br />
        However, since RDF (and thus N3) statements do not have an inherent order, this example loses meaning
        as we no longer know who can be considered the "first" author.
      </p>

      <p class="note">To an extent, an N3 collection is equivalent to the more verbose <a
          href="https://www.w3.org/TR/rdf11-mt/#rdf-collections">RDF Collection vocabulary</a>.</p>

      <p>In N3, collections may occur as subjects, predicates or objects in a statement. For instance:</p>
      <textarea class="n3code">@prefix : <http://example.org/#> .

(:Fred :Wilma :Dino) :approved :resolution123 .</textarea>
      <p>Or even:</p>
      <textarea class="n3code">@prefix : <http://example.org/#> .

(:Fred :Wilma :Dino) (:read :liked :approved) 
  (:resolution1 :resolution2 :resolution3) .</textarea>
      <p>As before: any meaning that goes beyond the fact that 3 <a>collection</a> resources are involved in this
        statement, would be application-specific.</p>
      <!-- &mdash; for instance, that the predicate
        <code>(:read :liked :approved)</code> means that the subject <a>collection</a> did all those things for all
        members in the object <a>collection</a>. -->
      <!--
          <pre class="example nohighlight">
          @prefix foaf: &lt;http://xmlns.com/foaf/0.1/&gt; .
          _:n3
            foaf:member (
              _:doerthe
              _:william
              _:dominik
            ).</pre>
              -->
    </section>
    <section id='quotedgraphs'>
      <h3>Quoted Graphs</h3>
      <p>
        It is often useful to attach metadata to groups of triples &mdash;
        to give the provenance, context, or version of the information, our opinion on the matter, and so on.
        We can use <dfn>quoted graphs</dfn> to quote RDF graphs, and then describe the <a>quoted graph</a> using <a>N3
          statements</a>. For instance:
      </p>
      <textarea class="n3code">@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix dc: <http://purl.org/dc/terms/> .
@prefix : <http://example.org/#> .

{ :cervantes dc:wrote :moby_dick } :opinion :lie ;
  :retrievedFrom <http://lies_r_us.com> ;
  :retrievedAt "2020-07-12T09:01:33"^^xsd:dateTime .</textarea>
      <p>
        Essentially, a <a>quoted graph</a> records of the occurrence of an RDF graph &mdash; i.e., a <em>quoting</em>
        or
        <em>citing</em> of the graph. Importantly, a <a>quoted graph</a> does not assert the contents of the RDF
        graph as being true (e.g., <code>:cervantes dc:wrote :moby_dick</code>). In fact, the <a>quoted graph</a> is
        interpreted as a resource on its own .
      </p>
      <p>As with <a>collections</a>, <a>quoted graphs</a> can be used in any position in an <a>N3 statement</a>.</p>
      <p>As they represent a <i>quoting</i> of RDF graphs, <a>quoted graphs</a> are not "referentially transparent".
        For
        instance:</p>
      <textarea class="n3code">@prefix : <http://example.org/#> .

:LoisLane :believes { :Superman :can :fly } .</textarea>
      <p>This <a>N3 statement</a> states that Lois Lane believes that Superman can fly.
        Even if it is known that <code>:Superman</code> is the same as <code>:ClarkKent</code>, one cannot infer from
        this that Lois Lane believes that <code>:ClarkKent</code> can fly.
        Indeed, this is an accurate depiction of Lois Lane's statement at the time &mdash;
        as she did not know that Superman is Clark Kent at that point,
        she would certainly not be saying that Clark Kent can fly.</p>
    </section>

    <section id='n3rules'>
      <h3>N3 Rules</h3>

      <p>N3 supports declarative programming by allowing to make statements about the world,
        including logical implications, or <dfn data-lt="logical implication|N3 rule">N3 rules</dfn>, which can be
        loosely compared to If-Then statements.
        Based on the N3 semantics, so-called inferences can be drawn from these statements.
        An N3 reasoner can draw such inferences automatically, to support
        problem solving, decision making, or simply enriching your Knowledge Graph.</p>

      <p>For instance, the following is an <a>N3 rule</a>:</p>

      <textarea class="n3code">@prefix foaf: <http://xmlns.com/foaf/0.1/> .
@prefix : <http://example.org/#>.

{ :weather a :Raining
} => {
  :weather a :Cloudy
} .</textarea>

      <p>
        This is a logical construct, such as a conjunction (AND) and disjunction (OR).
        Stating such a <a>logical implication</a> means that, in case the <dfn data-lt="premise|rule premise">rule
          premise</dfn> is true (it is raining),
        the <dfn data-lt="conclusion|rule conclusion">rule conclusion</dfn> must be true as well (it is cloudy).
        If this is not the case &mdash; raining does not imply that it is cloudy
        &mdash; the implication would be false.
        However, this is not possible, since all statements in N3 (and RDF) are true by default.
      </p>

      <p>
        Hence, when the <a>premise</a> holds, then we can safely infer the <a>conclusion</a>.
        This is also referred to as <dfn data-lt="fire|firing">firing</dfn> the rule.
        For the example above, if we state <code>:weather a :Raining</code>, then we can safely infer
        <code>:weater a :Cloudy</code>.
      </p>

      <p class="note">
        An <a>N3 rule</a> is actually a N3 statement, where the <a>subject</a> and <a>object</a> constitute <a>quoted
          graphs</a>,
        and the <a>predicate</a> is <code>log:implies</code>, with symbol <code>=&gt;</code> as syntactic sugar.
        <!-- For backward chaining rules (see <a href="n3rulechaining">rule chaining</a>), 
          the predicate is <code>log:impliedBy</code>, with symbol <code>&lt;=</code> as syntactic sugar. -->
        <!-- In fact, these predicates themselves are <a>N3 builtins</a>. -->
      </p>

      <section id='n3rulevars'>
        <h4>Rule Variables</h4>

        <p><a>N3 rules</a> are more useful when they include <dfn>variables</dfn>.
          For instance, the following includes a universal variable (prefixed by <code>?</code>):
        </p>
        <textarea class="n3code">@prefix foaf: <http://xmlns.com/foaf/0.1/> .
@prefix : <http://example.org/#>.

:spiderman a :SuperHero .

{ ?x a :SuperHero
} => {
  ?x a :Imaginary
} .</textarea>

        <p>
          This states that the <a>N3 rule</a> is true for each value of variable <code>?x</code>:
          when the <a>premise</a> is true for a particular value for <code>?x</code>
          (being a super hero),
          then the <a>conclusion</a> must be true for that value as well (being imaginary).
          For the example above, the <a>premise</a> is true for value <code>:spiderman</code>,
          meaning we can infer the <a>conclusion</a> for that value, i.e.,
          <code>:spiderman a :Imaginary</code>.
        </p>
        <p class="note">
          More technically, the triples in the <a>rule premise</a>
          (e.g., <code>?x a :SuperHero</code>) can be seen as <dfn><a
              href="https://www.w3.org/TR/sparql11-query/#QSynTriples">triple
              patterns</a></dfn>.
          In order to <a>fire</a> the rule, these triple patterns are matched to concrete triples
          in the <a>N3 document</a>.
          If a match is successful, concrete resources from the matching triple (e.g., <code>:spiderman</code>)
          are bound to the triple pattern's <a>variables</a> (e.g., <code>?x</code>).
          These bound variable values are then used in the inferred conclusion (e.g.,
          <code>:spiderman a :Imaginary</code>).
        </p>
      </section>

      <section id='n3rulechaining'>
        <h4>Rule Chaining</h4>

        <p>In practice, a pivotal feature is that <a>N3 rules</a> can be "chained":
          a rule can depend on the results of other rules. For example:
        </p>

        <textarea id="chaining_example" class="n3code">@prefix foaf: <http://xmlns.com/foaf/0.1/> .
@prefix : <http://example.org/#>.
            
:spiderman a :WebSlinger .
:44th :traffic :heavy .
            
{ ?slinger a :WebSlinger } => { ?slinger :locomotion :flying } .

{ ?heli a :Helicopter } => { ?heli :locomotion :flying  } .

{ ?flyer :locomotion :flying . ?street :traffic :heavy } 
  =>  { ?street :suitable-observer ?flyer } .</textarea>

        <p>
          The third <a>N3 rule</a> relies on the <a>rule conclusion</a> (<code>:locomotion</code>) of the first two
          rules:
          if one of those rules <a>fire</a>, i.e., inferring a flying locomotion for a resource,
          then the third rule would <a>fire</a> as well, i.e., inferring that the resource
          would be a suitable observer for a street with heavy traffic.
          <!-- Hence the term "chaining"; rules 1 and 2 each form a chain with rule 3. -->
          This allows for a modularization of N3 code:
          the first two rules separately decide when something supports a flying locomotion;
          the third rule determines what the general effects of flying locomotion are.
        </p>

        <p class="note">
          Variable names only have to be unique within a rule, and not across rules.
          For instance, in the <a href="#chaining_example">prior example</a>,
          we simply could have named every variable <code>?x</code>.
          As with general coding practices, it is typically a good idea to give variables a
          meaningful name.
        </p>
        </p>

        <p>
          <!-- TODO have a section on N3 reasoners -->
          An N3 reasoner, which can draw inferences from <a>N3 rules</a>,
          can operate in forward chaining, backward chaining, or some hybrid mode.
          An <a>N3 rule</a> can also indicate which mode should be used,
          by using the appropriate predicate.
          Up until now, we have been utilizing <code>=&gt;</code>, which is syntactic sugar for <code>log:implies</code>
          and
          directs the reasoner to operate in forward chaining mode.
          The <code>&lt;=</code> predicate, syntactic sugar for <code>log:impliedBy</code>, indicates a backward
          chaining mode.
        </p>
        <p>
          For instance, the following is equivalent to the <a href="#chaining_example">prior example</a>
          and combines forward and backward chaining:</p>
        <textarea class="n3code" id="backward_chaining_example">@prefix foaf: <http://xmlns.com/foaf/0.1/> .
@prefix : <http://example.org/#>.
            
:spiderman a :WebSlinger .

{ ?slinger :locomotion :flying } <= { ?slinger a :WebSlinger } .

{ ?heli :locomotion :flying } <= { ?heli a :Helicopter } .

{ ?flyer :locomotion :flying . ?street :traffic :heavy } 
  =>  { ?street :suitable-observer ?flyer } .</textarea>
        </p>

        <p>
          In a nutshell, forward reasoning presents a bottom-up approach:
          starting from a set of initial and inferred statements,
          a reasoner will <a>fire</a> any N3 rule where the <a>premise</a> holds,
          each time adding the inferences to the set, until no more N3 rules can be fired.
          Backward chaining is a top-down approach: given a query, such as <code>?x :locomotion :flying</code>,
          the reasoner will search for any rules with <a>conclusions</a> that may satisfy the query (e.g., first and
          second rule).
          Then, it will check whether the <a>premises</a> of those rules hold, which may, in itself,
          require searching for rules with matching <a>conclusions</a>.
          Regarding general expressivity, these two reasoning modes can be considered equivalent.
          A detailed discussion of these two reasoning modes, their subtle differences and impacts on performance,
          is beyond the scope of this primer.
        </p>
      </section>
    </section>

    <section id='builtins'>
      <h3>N3 Builtins</h3>
      <p>
        An <dfn data-lt="N3 builtin|builtin">N3 builtin</dfn> is used within a <a>N3 rule</a> to
        implement an arbitrary operation on an N3 <a>resource</a> or even an entire <a>N3 document</a>.
        Builtins include mathematic, string, time and cryptography operators,
        operations on collections and graphs, and logical operations in general.</p>

      <h4>Simple Builtins</h4>

      <p>
        <!-- An <a>N3 builtin</a> can be used within an <a>N3 rule</a> as part of an <a>N3 statement</a>. -->
        As a simple example, the rule below uses the <code>math:product</code> builtin to calculate a person's height in
        meters:
      </p>
      <textarea class="n3code" id="builtin_age_example">@prefix math: <http://www.w3.org/2000/10/swap/math#> .
@prefix : <http://example.org/#>.

{ ?person :heightInCm ?cm .
  ( ?cm 100 ) math:product ?m .
} => { ?person :heightInMeter ?m } .</textarea>
      <p>
        An <a>N3 builtin</a> is used as the <a>predicate</a> in an
        <dfn data-lt="N3 builtin statement|builtin statement">N3 builtin statement</dfn>,
        where the <a>subject</a> and <a>object</a> act as input or output arguments.
        In the example above, the second triple constitutes a <a>builtin statement</a>:
        the subject constitutes the input, as <code>math:product</code> calculates the product the subject
        <a>collection</a>
        elements
        (i.e., the person's height in cm and 100); the object constitutes the output,
        as the result is then bound to the object variable <code>?m</code>.
      </p>

      <h4>Builtins with Multiple Results</h4>

      <p><a>N3 builtins</a> can generate multiple results.
        Below, we use the <code>list:iterate</code> builtin to iterate over collection elements,
        and subsequently constructs a string for each element:</p>
      <textarea class="n3code" id="iterate_example">@prefix list: <http://www.w3.org/2000/10/swap/list#> .
@prefix string: <http://www.w3.org/2000/10/swap/string#> .
@prefix : <http://example.org/#>.

:race :finalists ( :flash :superman :spiderman ) .
          
{ :race "finalists ?finalists .
  ?finalists list:iterate ( ?i ?finalist ) .
  ( ?i ". " ?finalist "<br />" ) string:concatenation ?entry

} => { :race :entries ?entry } .</textarea>

      <p>
        The <code>list:iterate</code> builtin iterates over all elements in the subject collection
        (<code>?finalists</code>).
        For each element, it binds its index, and the element itself, to the variables in the object collection
        (<code>?i</code> and <code>?finalist</code>, respectively).
        Hence, the <code>list:iterate</code> builtin generates multiple sets of bindings for the <code>?i</code> and
        <code>?finalist</code>
        variables:<br />

        <code>( ?i = 1, ?finalist = :flash )</code><br />
        <code>( ?i = 2, ?finalist = :superman )</code><br />
        <code>( ?i = 3, ?finalist = :spiderman )</code><br />
        <br />

        For each set of bindings, the <code>string:concatenation</code> builtin concatenates the resources in the
        subject
        collection,
        and binds the result to the object variable (<code>?entry</code>). This will lead to the following output:<br />
        <code>
            1. flash<br />
            2. superman<br />
            3. spiderman<br />
          </code>
      </p>

      <p class="note">
        A <a>builtin statement</a> can be seen as a <a href="https://www.w3.org/TR/sparql11-query/#QSynTriples">triple
          pattern</a> that, for each builtin result,
        yields one or more "matching" triples depending on the builtin. For the example above:<br />
        <code>
            ( :flash :superman :spiderman ) list:iterate ( 1 :flash ) .<br />
            ( :flash :superman :spiderman ) list:iterate ( 2 :superman ) .<br />
            ( :flash :superman :spiderman ) list:iterate ( 3 :spiderman ) .<br />
          </code>
        <br />
        As with a <a href="https://www.w3.org/TR/sparql11-query/#QSynTriples">SPARQL</a> query, for each "matching
        triple",
        a join is attempted with the remaining triples in the rule <a>premise</a>.
        Hence, for each matching triple, the <code>string:concatenation</code> <a>builtin statement</a> is evaluated.
        Finally, for each consistent set of variable bindings, the rule conclusion is instantiated and inferred.
      </p>

      <h4>Scoped Negation as Failure (SNAF)</h4>

      <p>
        <a>N3 builtins</a> can also operate on a local <a>quoted graph</a> or even an entire <a>N3 document</a>.
        The <code>log:collectAllIn</code>, <code>log:forAllIn</code>, and <code>log:notIncludes</code> builtins are
        logical operators that
        support a negation-as-failure scoped on the <a>builtin statement</a> object:
        the object can be a quoted graph or a <a>blank node</a>, in which case the current document is the scope.
        For instance, the rule below uses <code>log:collectAllIn</code> to collect all of spiderman's defeated villains
        found in the current document:
      </p>
      <textarea class="n3code" id="collectallin_example">@prefix log: <http://www.w3.org/2000/10/swap/log#> . 
@prefix : <http://example.org/#>.

:spiderman a :SuperHero .
:green-goblin :enemyOf :spiderman ; :defeated true .
:doctor-octopus :enemyOf :spiderman ; :defeated true .
:sandman :enemyOf :spiderman ; :defeated false .

{ 
  ?hero a :SuperHero .
  (?enemy
  {
    ?enemy :enemyOf ?hero ;
      :defeated true .
  }
  ?enemies) log:collectAllIn _:t .

} => { ?hero :defeatedEnemies ?enemies } .</textarea>
      <p>
        The <code>log:collectAllIn</code> builtin accepts as subject a collection that includes:
      <ul>
        <li>a variable of which the values will be collected (<code>?enemy</code>),</li>
        <li>a <i>where</i> clause with triple patterns that constrain this variable, and</li>
        <li>a variable bound to the resulting collection of values (<code>?enemies</code>).</li>
      </ul>
      The <i>where</i> clause is evaluated on the given scope, in this case, the current <a>N3 document</a>;
      all potential results beyond this scope are considered false (SNAF).
      This leads to the following result:<br />
      &nbsp;&nbsp;&nbsp;&nbsp;<code>:spiderman :defeatedEnemies ( :green-goblin :doctor-octopus )</code><br />
      </p>
      <p>
        The example below uses <code>log:forAllIn</code> to determine whether a super-hero's identity is safe:</p>
      <textarea class="n3code" id="forallin_example">@prefix log: <http://www.w3.org/2000/10/swap/log#> . 
@prefix : <http://example.org/#> .

:spiderman a :SuperHero .
:mary-jane :knowsIdentityOf :spiderman ;
  :keepsSecrets true .
:aunt-may :knowsIdentityOf :spiderman ;
  :keepsSecrets true .

  { 
    ?hero a :SuperHero .
    ( { ?person :knowsIdentityOf ?hero } { ?person :keepsSecrets true } )               
      log:forAllIn _:t .

} => { ?hero :secretIdentitySafe true } .</textarea>
      <p>The <code>log:forAllIn</code> builtin accepts as subject a collection with two clauses of a logical
        implication.
        If, for all cases where the first clause holds, the second clause holds as well,
        then the logical implication is true.
        In this example, the implication is true when, for each person who knows the identity of spiderman,
        this person can keep a secret.
        In this case the rule will fire, as both <code>mary-jane-watson</code> and <code>aunt-may</code> can keep
        secrets.
      </p>

      <p class="note">
        In the two examples above, the <a>blank node</a> object <code>_:t</code> indicates the current <a>N3
          document</a>
        as scope. Alternatively, a <a>quoted graph</a> can be used as the scope as well.
        This is illustrated in the <code>log:notIncludes</code> example below.
      </p>

      <p>
        The <code>log:notIncludes</code> builtin checks whether the given scope <i>does not include</i> a given clause.
        The example below uses a <a>quoted graph</a> as scope, instead of the current <a>N3 document</a>,
        as was the case for the prior two examples.
        The rule finds any of spiderman's enemies who have not been defeated, at least,
        as reported by the Daily Bugle:</p>
      <textarea class="n3code" id="notincludes_example">@prefix log: <http://www.w3.org/2000/10/swap/log#> . 
@prefix : <http://example.org/#> .    

:spiderman :hasEnemy :green-goblin , :doctor-octopus, :sandman .
{
  :green-goblin :defeatedBy :spiderman .
  :doctor-octopus :defeatedBy :spiderman .

  } :reportedBy :daily_bugle .

{ 
  :spiderman :hasEnemy ?enemy .
  ?graph :reportedBy :daily_bugle .
  ?graph log:notIncludes { ?enemy :defeatedBy ?hero } .

} => { ?enemy a :Undefeated } .</textarea>
      <p>For each of spiderman's enemies (<code>?enemy</code>), the rule checks whether the <a>quoted graph</a>
        <code>?graph</code>,
        as reported by the <code>:daily_bugle</code>, does not include any statement where the enemy has been defeated.
        If so, we infer that this enemy is undefeated, in this case, <code>:sandman</code>.
      </p>

      <p class="note">
        The counterpart of <code>log:notIncludes</code> is <code>log:includes</code>, which checks whether the given
        object scope
        <i>includes</i> a given clause.
      </p>

      <h4>Access Online Knowledge</h4>
      <p>
        To dynamically retrieve online knowledge within an <a>N3 rule</a>,
        <code>log:semantics</code> and <code>log:conclusion</code> builtins allow pulling in, parsing, and reasoning
        over logical expressions from online sources.
      </p>
      <!-- <p>
        The example below uses <code>log:content</code> to retrieve an online HTML page,
        and subsequently extracts its title:
      <pre id="content_example" class="example nohighlight" data-transform="updateExample"> -->
      <!--
            @prefix log: <http://www.w3.org/2000/10/swap/log#> . 
            @prefix string: <http://www.w3.org/2000/10/swap/string#> . 

            {
                <http://example.com> log:content ?content .
                ( ?content "<title>(.*?)</title>") string:scrape ?title .
            } => {
                <http://example.com> :title ?title . 
            } .
          -->
      <!-- </pre>
      </p> -->

      <p>
        In the rule below, the <code>log:semantics</code> builtin retrieves an online source and subsequently parses it
        a
        <a>quoted
          graph</a>:
      </p>
      <textarea class="n3code" id="content_example">@prefix log: <http://www.w3.org/2000/10/swap/log#> . 
@prefix : <http://example.com> .

{ 	
  <https://raw.githubusercontent.com/w3c/N3/master/tests/N3Tests/people.n3> log:semantics ?g .
  ( ?person { ?person a :Person  } ?persons ) 
      log:collectAllIn ?g .
                 
} => { 
  <https://raw.githubusercontent.com/w3c/N3/master/tests/N3Tests/people.n3>
    :people ?persons
} .</textarea>
      <p>Subsequently, <code>log:collectAllIn</code> is used to collect all persons found within the online source.
      </p>

      <p>
        The <code>log:conclusion</code> builtin allows generating the closure of a given <a>quoted graph</a>,
        i.e., extending the graph with all applicable rule inferences.
        This includes <a>quoted graphs</a> retrieved and parsed from online sources. For example:</p>
      <textarea class="n3code" id="content_example">@prefix log: <http://www.w3.org/2000/10/swap/log#> . 
@prefix : <http://example.com/> .

{  <https://raw.githubusercontent.com/w3c/N3/master/tests/N3Tests/rules.n3> log:semantics ?g .
   ?g log:conclusion ?closure .
                
} => { 
   <https://raw.githubusercontent.com/w3c/N3/master/tests/N3Tests/rules.n3>
     :inferences ?closure
} .</textarea>
      <p>
        Instead of simply printing the inferences, one could, e.g., use the <code>log:forAllIn</code> builtin to
        check whether all persons listed in the online source are indeed inferred to be animals as well.
      </p>
    </section>

    <section id='paths'>
      <h3>Resource Paths</h3>
      <p>Similar to <a href="https://www.w3.org/TR/sparql11-query/#propertypaths">SPARQL property paths</a>,
        N3 <dfn>resource paths</dfn> concisely express paths between resources,
        when intermediary resources on the path are not relevant.
        In practice, <a>resource paths</a> are most useful in <a href="#n3rules">N3 rules</a>.</p>

      <p>A <a>resource path</a> starts from a subject resource, followed by one or more predicates;
        each predicate is separated by a <dfn>directional indicator</dfn> to follow the predicate either forward
        (<code>!</code>)
        or in reverse (<code>^</code>).
        For example, the following example describes the city of Joe's mother's office's address:</p>

      <textarea class="n3code">@prefix : <http://example.org/#> .

:joe!:hasMother!:hasOffice!:hasAddress :hasCity "Metropolis" .</textarea>

      <p>In this example, the intermediary resources &mdash; Joe's mother, her office, and its address &mdash;
        are not described or referenced further, so the more concise <a>resource path</a> syntax can be used.</p>

      <p>The expansion of this shorthand syntax uses blank nodes to express the path between the two resources.
        The example above is equivalent to the following (using blank node identifiers for clarity):</p>

      <textarea class="n3code">@prefix : <http://example.org/#> .

:joe :hasMother _:m . 
_:m :hasOffice _:o . 
_:o :hasAddress _:a . 
_:a :hasCity "Metropolis" .</textarea>

      <p>In other words, each predicate in <a>resource path</a> is expanded into a statement,
        with as subject either the starting resource, or prior blank node object; and as object a newly minted blank
        node. </p>

      <p>Relations can also be followed in reverse using the reverse (<code>^</code>) indicator.
        The following example, starting from <code>joe</code>, follows the <code>hasMother</code> predicate to Joe's
        mother,
        and then follows the <code>hasMother</code> predicate in reverse (thus pointing to someone who has the same
        mother):</p>

      <textarea class="n3code">@prefix : <http://example.org/#> .

:joe!:hasMother^:hasMother a :Person .</textarea>

      <p>This could equally well be represented by the more verbose:</p>

      <textarea class="n3code">@prefix : <http://example.org/#> .

:joe :hasMother _:m.
_:d :hasMother _:m.
_:d a :Person.</textarea>

      <p class="note">In SPARQL, a property path is used in the
        predicate position to describe a string of relationships between
        a subject and an object resource.
        In contrast, an N3 <a>resource path</a> is most often used in the subject or
        object position.
        Using a <a>resource path</a> in the predicate position, although technically allowed, is often a mistake.
        For instance, the following N3 <a>resource path</a>: <br />
        &nbsp;&nbsp;&nbsp;&nbsp;<code>:joe :hasAddress!:hasCity "Metropolis" .</code><br />
        Would lead to the following expansion:<br />
        &nbsp;&nbsp;&nbsp;&nbsp;<code>:joe _:bn_1 "Metropolis" .</code><br />
        &nbsp;&nbsp;&nbsp;&nbsp;<code>:hasAddress :hasCity _:bn_1 .</code><br />
        Which is likely not the intention of the author.
      </p>

    </section>
  </section>
  <section id='patterns' class=informative>
    <h2>Design Patterns</h2>
    <p>In this section, we present common patterns to solve often-occurring problems, for instance regarding data
      modeling, in N3.</p>
    <section id="naryrel">
      <h3>N-ary Relations</h3>
      <p>Until now, we only considered binary relations between entities and/or values. But, many types of relations
        are
        <em>ternary, quaternary, or, in general, n-ary in nature</em>, i.e., they have an arbitrary number of
        participants. Typical examples are purchase, employment or membership relations.
      </p>
      <p>In other cases, we want to describe <em>properties of relations</em> &mdash; such as the provenance of a
        piece
        of information, or the probability of a diagnosis. But, in essence, this is the same problem as representing
        n-ary relations.</p>
      <p>There are several ways of representing n-ary relations in RDF &mdash; these are described in
        <a href="https://www.w3.org/TR/swbp-n-aryRelations/">swbp-n-aryRelations</a>.
      </p>
      <p>Below, we illustrate options for representing n-ary relations in N3 in particular.</p>
      <section id="nary-binary-rel">
        <h3>Using sets of binary relations</h3>
        <p>In general, it is possible to convert any n-ary relation into an equivalent set of binary relations. This
          is
          a convenient solution, since we already know how to represent binary relations.</p>
        <p>First, we <em>create a resource</em> that represents the n-ary relation, and then <em>use a set of binary
            relations</em> to link each participant to this newly minted resource. Each binary relation is hereby
          given
          a meaningful name that <em>represents the role of the participant</em> in the n-ary relation.</p>
        <p>For instance, say we want to describe the <em>Purchase</em> relation between a buyer called "John", a
          purchased book called "Lenny the Lion", the amount paid for the book, and the seller:</p>
        <textarea class="n3code" id="nary-book-relation">@prefix : <http://example.org/#> .

:Purchase_1 a :Purchase ;
  :hasBuyer :John ;
  :hasObject :Lenny_The_Lion ;
  :hasAmount 15 ;
  :hasSeller <http://books.example.com> .</textarea>
        <p class="note">Either you could mint a new <a>IRI</a> for representing the n-ary relation, or simply use a <a
            href="#bnodes">blank node</a>. In case other parties may want to refer to the n-ary relation from
          outside the N3 graph, one could choose to mint a new <a>IRI</a>.</p>
        <p>In other cases, things are more naturally described as <em>properties of relations</em>, rather than n-ary
          relations &mdash; for instance, the provenance of a piece of information, the trend of someone's body
          temperature and when the temperature was taken. Nevertheless, these can be represented in the same way as
          n-ary relation participants.</p>
        <p>We start from the same solution above, i.e., introducing a resource to represent the (in this case, binary)
          relation, and then linking the two participants to this resource. Subsequently, we use a set of binary
          relations to attach each descriptive property (e.g., diagnosis probability; temperature trend) to the
          relation
          resource.</p>
        <!-- <p>For instance, when describing a diagnosis (e.g., breast cancer) of someone (e.g., Christine), you may want to indicate the probability of the diagnosis, and the date at which the diagnosis was made:</p>
            <pre id="" class="example nohighlight">
            @prefix ex: &lt;http://example.org/#&gt; .
            @base &lt;http://example.org/#&gt; .
            @prefix xsd: &lt;http://www.w3.org/2001/XMLSchema#&gt; .
            ex:Christine
              a       :Person ;
              :hasDiagnosis _:Diagnosis_Relation_1 .

            _:Diagnosis_Relation_1
              :diagnosisProbability :HIGH ;
              :diagnosisValue :Breast_Tumor_Christine ;
              :diagnosisDate ""
            </pre> -->
        <p>For instance, when describing someone's (e.g., Christine) current temperature, you may want to indicate the
          absolute value (e.g., 40 degrees), a description of that value (e.g., elevated), the trend compared to the
          prior value (e.g., rising), and the time the temperature was taken:</p>
        <textarea class="n3code">@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix : <http://example.org/#> .

:Christine a :Person ;
  :hasTemperature _:to1 .

_:to1 :temperatureTrend :RISING ;
  :temperatureValue 40 ;
  :temperatureDescription :ELEVATED ;
   :temperatureTime "2020-07-12T09:01:33"^^xsd:dateTime .</textarea>
        <p>This is possible since we know that the relation resource (e.g., <code>_:to1</code>) represents the n-ary
          relation. Hence, any descriptive properties of the relation, in addition to participants in the relation,
          can
          simply be attached to the entity.</p>
        <p class="note">In this example, we made a statement with one of the participants (<code>:Christine</code>) as
          subject, and the relation resource (<code>_:to1</code>) as object. An alternative would have been to
          add
          <code>:Christine</code> as just another element of the n-ary relation, e.g., using a property
          <code>temperatureOf</code>. Our modeling choice here aimed to indicate that Christine is somehow the <a
            href="https://www.w3.org/TR/swbp-n-aryRelations/#useCase2">"owner" of the relationship</a>.
        </p>
        <!--
            (NOTE from a data modeling perspective, there would be a clear problem if the relation entity could have multiple "subjects" &mdash; e.g., in case it is being re-used to represent the same diagnosis for multiple patients. In that case, each of the patients'
            diagnosis probabilities would be linked to the same relation entity &mdash; and we lose the link that tells us which probability belongs to which patient. This can be seen as a kind of "fan trap".)
            -->
      </section>
      <section>
        <h3>Using collections</h3>
        <p>An alternative solution is to use a <a>collection</a> to keep all the participants of the n-ary relation.
          For instance:</p>
        <textarea class="n3code">@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix : <http://example.org/#> .

:avengers :members ( :iron_man :captain_america :spiderman ) .</textarea>
        <p>A clear advantage of this approach is that it is easier and much less verbose to write down.
          However, the roles each participant play in the n-ary relation are no longer explicated.
          This is not a problem when the participants do not have different roles, as in the example above &mdash;
          they all play the same role of group member.
        </p>
      </section>
    </section>
    <section id="compoundliteral">
      <h3>Compound literal</h3>
      <p>This solution is inspired by a separate discussion within the RDF community on <em>Language Tagged
          Strings</em>.
        The essence of the discussion is to separate the string, as a simple data, from its various characterizations,
        such as reading direction and language.
        This design pattern uses the <code>rdf:CompoundLiteral</code> class together with the
        <code>rdf:language</code>, <code>rdf:direction</code>, and <code>rdf:value</code> properties
        to respectively describe literal values on the base direction, language, and string value of the subject.
      </p>
      <textarea class="n3code">@prefix foaf: <http://xmlns.com/foaf/0.1/> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .

<http://example.org/#spiderman> foaf:name [
  rdf:value "الرجل العنكبوت" ;
  rdf:language "ar-eg" ;
  rdf:direction "rtl"
] .</textarea>
    </section>
    <section id="reification">
      <h3>Quoted graphs</h3>
      <p><a>Quoted graphs</a> allow attaching metadata to groups of triples,
        such as the provenance, context, version, opinion, probability, etc.
        See the example below:</p>
      <textarea class="n3code">@prefix : <http://example.org/>  .

_:x :graph {
  <http://example.org/#spiderman> <http://xmlns.com/foaf/0.1/name> "Peter Parker" .
} .
_:x :certainty 0.8 .</textarea>
      <p>Importantly, as discussed in the <a>quoted graphs</a> section,
        a quoted graph does not assert the contents of the RDF graph as being true.
        This allows expressing examples such as above,
        where the statement within the quoted graph should not be asserted.</p>
    </section>
  </section>
  <section id="useful_resources">
    <h2>Useful Resources</h2>
    <p>
      Here, we list useful tools and educational resources on N3.
      For other related work, such as publications and projects,
      we refer to the <a href="https://github.com/w3c/N3/tree/master/relatedWork#projects-and-materials">W3C CG
        documentation</a>.
    </p>
  </section>
</body>

</html>